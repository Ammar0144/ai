<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Service API Documentation</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            color: #333;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            text-align: center;
        }
        .endpoint {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .method {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            color: white;
            font-size: 0.8em;
        }
        .post { background-color: #28a745; }
        .get { background-color: #007bff; }
        .path {
            font-family: 'Courier New', monospace;
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 4px;
            margin-left: 10px;
        }
        .description {
            margin: 10px 0;
            color: #666;
        }
        .example {
            background: #f1f3f4;
            border-left: 4px solid #4285f4;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }
        .example pre {
            margin: 0;
            overflow-x: auto;
        }
        .swagger-link {
            background: #17a2b8;
            color: white;
            padding: 12px 24px;
            text-decoration: none;
            border-radius: 6px;
            display: inline-block;
            margin-top: 1rem;
        }
        .swagger-link:hover {
            background: #138496;
            color: white;
            text-decoration: none;
        }
        .nav {
            background: #fff;
            border-bottom: 1px solid #e9ecef;
            padding: 1rem 0;
            margin-bottom: 2rem;
        }
        .nav a {
            color: #495057;
            text-decoration: none;
            margin-right: 2rem;
            font-weight: 500;
        }
        .nav a:hover {
            color: #007bff;
        }
        .tag {
            background: #6f42c1;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.75em;
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ü§ñ AI Service API</h1>
        <p>Comprehensive AI capabilities powered by DistilGPT-2 with advanced rate limiting, CORS support, and robust error handling</p>
        <a href="/swagger/" class="swagger-link">üöÄ Interactive Swagger UI</a>
    </div>

    <div class="nav">
        <a href="#security">Security</a>
        <a href="#health">Health</a>
        <a href="#processing">AI Processing</a>
        <a href="#legacy">Legacy</a>
        <a href="#examples">Examples</a>
    </div>

    <section id="security">
        <h2>üîí Security & Rate Limiting</h2>
        
        <div class="endpoint">
            <h3>üõ°Ô∏è Security Features</h3>
            <p class="description">The AI Service includes comprehensive security and performance protections:</p>
            <div class="example">
                <strong>Security Features:</strong>
                <ul>
                    <li><strong>IP-based Rate Limiting:</strong> Prevents abuse and ensures fair usage</li>
                    <li><strong>CORS Support:</strong> Configurable cross-origin resource sharing</li>
                    <li><strong>Proxy Header Support:</strong> Handles X-Real-IP and X-Forwarded-For headers</li>
                    <li><strong>Automatic Cleanup:</strong> Prevents memory leaks with regular IP cache cleanup</li>
                </ul>
            </div>
        </div>

        <div class="endpoint">
            <h3>‚è±Ô∏è Rate Limits per IP Address</h3>
            <p class="description">Different endpoints have different rate limits to balance performance and availability:</p>
            <div class="example">
                <strong>Rate Limits (per minute):</strong>
                <ul>
                    <li><strong>AI Processing Endpoints:</strong> 30 requests/minute
                        <ul>
                            <li>/ai/message, /ai/chat/completions, /ai/embeddings</li>
                            <li>/ai/classifications, /ai/summarization, /ai/sentiment</li>
                            <li>/ai/ask</li>
                        </ul>
                    </li>
                    <li><strong>Health Check:</strong> 200 requests/minute
                        <ul><li>/health</li></ul>
                    </li>
                    <li><strong>Model Information:</strong> 100 requests/minute
                        <ul><li>/ai/model-info</li></ul>
                    </li>
                </ul>
                <strong>Rate Limit Exceeded Response (429):</strong>
                <pre>{
  "error": "Rate limit exceeded",
  "code": 429,
  "message": "Too many requests. Please try again later."
}</pre>
            </div>
        </div>
    </section>

    <section id="health">
        <h2>üè• Health Endpoints</h2>
        
        <div class="endpoint">
            <h3>
                <span class="method get">GET</span>
                <span class="path">/health</span>
                <span class="tag">Health</span>
            </h3>
            <p class="description">Returns the health status of the AI service</p>
            <div class="example">
                <strong>Response:</strong>
                <pre>{
  "status": "healthy",
  "timestamp": "2025-09-20T10:30:00Z",
  "version": "1.0.0"
}</pre>
            </div>
        </div>
    </section>

    <section id="processing">
        <h2>üß† AI Processing Endpoints</h2>

        <div class="endpoint">
            <h3>
                <span class="method post">POST</span>
                <span class="path">/ai/chat/completions</span>
                <span class="tag">AI Processing</span>
            </h3>
            <p class="description">Generate a chat completion based on conversation history</p>
            <div class="example">
                <strong>Request:</strong>
                <pre>{
  "messages": [
    {"role": "user", "content": "What is AI?"},
    {"role": "assistant", "content": "AI is..."},
    {"role": "user", "content": "Give me examples"}
  ],
  "max_tokens": 150,
  "temperature": 0.7,
  "user_id": "user123"
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <h3>
                <span class="method post">POST</span>
                <span class="path">/ai/embeddings</span>
                <span class="tag">AI Processing</span>
            </h3>
            <p class="description">Generate vector embeddings for the given text</p>
            <div class="example">
                <strong>Request:</strong>
                <pre>{
  "text": "This is sample text for embedding",
  "user_id": "user123"
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <h3>
                <span class="method post">POST</span>
                <span class="path">/ai/classifications</span>
                <span class="tag">AI Processing</span>
            </h3>
            <p class="description">Classify text into predefined categories</p>
            <div class="example">
                <strong>Request:</strong>
                <pre>{
  "text": "This product is amazing!",
  "categories": ["positive", "negative", "neutral"],
  "user_id": "user123"
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <h3>
                <span class="method post">POST</span>
                <span class="path">/ai/summarization</span>
                <span class="tag">AI Processing</span>
            </h3>
            <p class="description">Generate a summary of the provided text</p>
            <div class="example">
                <strong>Request:</strong>
                <pre>{
  "text": "Long text that needs to be summarized...",
  "max_length": 100,
  "user_id": "user123"
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <h3>
                <span class="method post">POST</span>
                <span class="path">/ai/sentiment</span>
                <span class="tag">AI Processing</span>
            </h3>
            <p class="description">Analyze the sentiment of the provided text</p>
            <div class="example">
                <strong>Request:</strong>
                <pre>{
  "text": "I love this product!",
  "user_id": "user123"
}</pre>
            </div>
        </div>
    </section>

    <section id="legacy">
        <h2>üîÑ Legacy Endpoints</h2>
        
        <div class="endpoint">
            <h3>
                <span class="method post">POST</span>
                <span class="path">/api/message</span>
                <span class="tag">Legacy</span>
            </h3>
            <p class="description">Legacy endpoint for processing messages (backward compatibility)</p>
            <div class="example">
                <strong>Request:</strong>
                <pre>{
  "message": "Hello, how are you?",
  "user_id": "user123"
}</pre>
            </div>
        </div>
    </section>

    <section id="examples">
        <h2>üéØ Quick Test Examples</h2>
        
        <div class="example">
            <strong>Test Health Check:</strong>
            <pre>curl http://localhost:8081/health</pre>
        </div>

        <div class="example">
            <strong>Test Chat Completion:</strong>
            <pre>curl -X POST "http://localhost:8081/ai/chat/completions" \
     -H "Content-Type: application/json" \
     -d '{
       "messages": [{"role": "user", "content": "What is AI?"}],
       "max_tokens": 100
     }'</pre>
        </div>

        <div class="example">
            <strong>Test Sentiment Analysis:</strong>
            <pre>curl -X POST "http://localhost:8081/ai/sentiment" \
     -H "Content-Type: application/json" \
     -d '{
       "text": "I love this new feature!"
     }'</pre>
        </div>

        <div class="example">
            <strong>Test Classification:</strong>
            <pre>curl -X POST "http://localhost:8081/ai/classifications" \
     -H "Content-Type: application/json" \
     -d '{
       "text": "This is fantastic!",
       "categories": ["positive", "negative", "neutral"]
     }'</pre>
        </div>
    </section>

    <footer style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid #e9ecef; text-align: center; color: #666;">
        <p>üìö For interactive testing, visit the <a href="/swagger/">Swagger UI</a></p>
        <p>üîß AI Service API v1.0.0 - Powered by DistilGPT-2</p>
    </footer>
</body>
</html>